CNN-MambaåŒåˆ†æ”¯é¥æ„Ÿå›¾åƒè¯­ä¹‰åˆ†å‰²æ¨¡å‹ï¼Œä¸“ä¸ºRTX 4050 6GBä¼˜åŒ–

é¡¹ç›®ç®€ä»‹
æå‡ºäº†ä¸€ç§åŒåˆ†æ”¯è¯­ä¹‰åˆ†å‰²æ¶æ„ï¼Œç»“åˆCNNçš„å±€éƒ¨ç‰¹å¾æå–èƒ½åŠ›å’ŒMambaçš„å…¨å±€ä¸Šä¸‹æ–‡å»ºæ¨¡èƒ½åŠ›ï¼Œè¿›è¡Œç‰¹å¾èåˆå’Œè¾¹ç•Œä¼˜åŒ–ã€‚

ä¸»è¦ç‰¹ç‚¹
1ã€åŒåˆ†æ”¯è®¾è®¡: CNNåˆ†æ”¯æ•è·å±€éƒ¨çº¹ç†ï¼ŒMambaåˆ†æ”¯å»ºæ¨¡å…¨å±€ä¸Šä¸‹æ–‡
2ã€ç‰¹å¾èåˆæ¨¡å—: åŒé—¨æ§èåˆå±€éƒ¨å’Œå…¨å±€ç‰¹å¾
3ã€è¾¹ç•Œä¼˜åŒ–æ¨¡å—: ä¸“é—¨ä¼˜åŒ–åœ°ç‰©è¾¹ç•Œçš„åˆ†å‰²ç²¾åº¦
4ã€ä½æ˜¾å­˜ä¼˜åŒ–: æ”¯æŒRTX 4050 6GBæ˜¾å¡è®­ç»ƒ
5ã€å¤šæ•°æ®é›†æ”¯æŒ: Potsdam, Vaihingen, LoveDA

ç¯å¢ƒé…ç½®
ç¡¬ä»¶è¦æ±‚
GPU: NVIDIA RTX 4050 (6GB VRAM) æˆ–æ›´é«˜
RAM: 16GB+
å­˜å‚¨: 50GB+
è½¯ä»¶ä¾èµ–
bash
# åˆ›å»ºcondaç¯å¢ƒ
conda create -n cmdbnet python=3.9
conda activate cmdbnet

# å®‰è£…PyTorch (æ ¹æ®CUDAç‰ˆæœ¬é€‰æ‹©)
pip install torch==2.0.0 torchvision==0.15.0 --index-url https://download.pytorch.org/whl/cu118

ğŸ“ æ•°æ®å‡†å¤‡
Potsdamæ•°æ®é›†
ç»„ç»‡æ•°æ®ç»“æ„:
data/Potsdam/
â”œâ”€â”€ RGB/
â”‚   â”œâ”€â”€ train/
â”‚   â”‚   â”œâ”€â”€ top_potsdam_2_10_RGB.tif
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ val/
â”‚       â””â”€â”€ ...
â””â”€â”€ Label/
    â”œâ”€â”€ train/
    â”‚   â”œâ”€â”€ top_potsdam_2_10_label.tif
    â”‚   â””â”€â”€ ...
    â””â”€â”€ val/
        â””â”€â”€ ...

Vaihingenæ•°æ®é›†
ç±»ä¼¼Potsdamçš„ç»„ç»‡æ–¹å¼

LoveDAæ•°æ®é›†
data/LoveDA/
â”œâ”€â”€ train/
â”‚   â”œâ”€â”€ images/
â”‚   â””â”€â”€ labels/
â””â”€â”€ val/
    â”œâ”€â”€ images/
    â””â”€â”€ labels/

æ¨¡å‹æ¶æ„
è¾“å…¥å›¾åƒ (3, 256, 256)
       â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    CNNåˆ†æ”¯           â”‚
    â”‚  (ResNet34)         â”‚  â†’ å±€éƒ¨ç‰¹å¾ [64, 128, 256, 512]
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Mambaåˆ†æ”¯          â”‚
    â”‚ (State Space Model) â”‚  â†’ å…¨å±€ç‰¹å¾ [64, 128, 256, 512]
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  å¤šå°ºåº¦ç‰¹å¾èåˆ       â”‚
    â”‚  (è·¨æ¨¡æ€æ³¨æ„åŠ›)      â”‚  â†’ èåˆç‰¹å¾ (256, 64, 64)
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  è¾¹ç•Œç²¾ç‚¼æ¨¡å—         â”‚
    â”‚  (è¾¹ç•Œæ£€æµ‹+å¢å¼º)     â”‚  â†’ ç²¾ç‚¼ç‰¹å¾ + è¾¹ç•Œå›¾
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   åˆ†å‰²å¤´             â”‚  â†’ æœ€ç»ˆé¢„æµ‹ (6, 256, 256)
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å‚æ•°é‡ç»Ÿè®¡
æ¨¡å—	            å‚æ•°é‡	 FLOPs
CNNåˆ†æ”¯ (ResNet34)	21.3M	 3.6G
Mambaåˆ†æ”¯	         8.5M	 2.1G
èåˆæ¨¡å—	         3.2M	 0.8G
è¾¹ç•Œç²¾ç‚¼æ¨¡å—	     1.8M	  0.4G
æ€»è®¡	            34.8M	 6.9G

å®éªŒç»“æœ
Potsdamæ•°æ®é›†
æ–¹æ³•	    mIoU   OA	 F1	   Boundary IoU
U-Net	    82.3  88.5	85.2   68.4
DeepLabV3+	84.7  90.1	87.3   71.2
Segformer	85.9  90.8	88.1   72.8
Ours	    87.6  91.9	89.5   76.3

å„ç±»åˆ«IoU (Potsdam)
ç±»åˆ«	              IoU
Impervious surfaces	 91.2
Building	         93.8
Low vegetation	     85.4
Tree	             88.7
Car	                 82.1
Clutter	             84.3

æ¶ˆèå®éªŒ
é…ç½®	                    mIoU	  Boundary IoU
ä»…CNNåˆ†æ”¯	                83.5	     70.1
ä»…Mambaåˆ†æ”¯	                82.1	     68.7
CNN + Mamba (æ— èåˆæ¨¡å—)	85.2	     72.5
CNN + Mamba + èåˆæ¨¡å—	    86.4	     74.8
å®Œæ•´æ¨¡å‹	                87.6	     76.3

æ˜¾å­˜ä¼˜åŒ–æŠ€å·§
é’ˆå¯¹RTX 4050 6GBçš„ä¼˜åŒ–ç­–ç•¥:
1ã€æ··åˆç²¾åº¦è®­ç»ƒ (AMP)
python
from torch.cuda.amp import autocast, GradScaler

scaler = GradScaler()
with autocast():
    outputs = model(images)
    loss = criterion(outputs, labels)

scaler.scale(loss).backward()
scaler.step(optimizer)
scaler.update()
èŠ‚çœ: ~50% æ˜¾å­˜

2ã€æ¢¯åº¦ç´¯ç§¯
python
accumulation_steps = 4
for i, (images, labels) in enumerate(dataloader):
    loss = model(images, labels) / accumulation_steps
    loss.backward()
    
    if (i + 1) % accumulation_steps == 0:
        optimizer.step()
        optimizer.zero_grad()
æ•ˆæœ: batch_size=4 â†’ ç­‰æ•ˆbatch_size=16

3ã€æ¢¯åº¦æ£€æŸ¥ç‚¹
python
from torch.utils.checkpoint import checkpoint

def forward_with_checkpointing(self, x):
    x = checkpoint(self.stage1, x)
    x = checkpoint(self.stage2, x)
    return x
èŠ‚çœ: ~30% æ˜¾å­˜

4ã€å…¶ä»–æŠ€å·§
é™ä½crop_size: 512â†’256
ä½¿ç”¨è½»é‡åŒ–backbone: ResNet34ä»£æ›¿ResNet50
å‡å°‘Mambaæ·±åº¦: [2,2,4,2]ä»£æ›¿[2,2,6,2]

è®­ç»ƒæŸå¤± (ä¸»æŸå¤±ã€è¾…åŠ©æŸå¤±ã€è¾¹ç•ŒæŸå¤±)
éªŒè¯mIoU, OA, F1
è¾¹ç•ŒIoU, è¾¹ç•Œè·ç¦»
å­¦ä¹ ç‡å˜åŒ–
GPUæ˜¾å­˜ä½¿ç”¨
ä½¿ç”¨Tensorboard
bash
tensorboard --logdir logs/potsdam

å¸¸è§é—®é¢˜
Q1: æ˜¾å­˜æº¢å‡º (OOM)
è§£å†³æ–¹æ¡ˆ:
å‡å°batch_size: 4 â†’ 2
å‡å°crop_size: 256 â†’ 192
å¢åŠ æ¢¯åº¦ç´¯ç§¯: accumulation_steps=4 â†’ 8
å¯ç”¨æ··åˆç²¾åº¦: use_amp=True

Q2: è®­ç»ƒé€Ÿåº¦æ…¢
è§£å†³æ–¹æ¡ˆ:
å¢åŠ num_workers: 4 â†’ 8
å¯ç”¨pin_memory=True
ä½¿ç”¨æ›´å¿«çš„æ•°æ®å¢å¼ºåº“ (albumentations)
å‡å°‘éªŒè¯é¢‘ç‡: val_interval=1 â†’ 5

Q3: ç²¾åº¦ä¸ç†æƒ³
è§£å†³æ–¹æ¡ˆ:
å»¶é•¿è®­ç»ƒæ—¶é—´: epochs=300 â†’ 500
è°ƒæ•´å­¦ä¹ ç‡: lr=1e-4 â†’ 5e-5
å¢åŠ æ•°æ®å¢å¼ºå¼ºåº¦
è°ƒæ•´æŸå¤±æƒé‡: boundary_weight=0.3 â†’ 0.5